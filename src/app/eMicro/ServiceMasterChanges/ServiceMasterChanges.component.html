<section class="content-header">
    <h1 class="display-1">
        Service Master Changes
        <small>Changes</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-database" aria-hidden="true"></i> Home</a></li>
        <li class="active">Service Master Changes</li>
    </ol>
</section>
<!-- Main content -->
<section class="content">
    <div class="box">
        <div class="box-header">
            <div class="col-xs-6">
                <h3 class="box-title">Service Master Changes</h3>
                <span class="label label-danger" *ngIf="errMsg.length>0">{{errMsg}}</span>
            </div>
            <div class="col-xs-6">
                <button type="button" class="btn btn-primary pull-right" (click)="onClickNewRequest()"><i
                        class="fa fa-plus" aria-hidden="true"></i> New Request</button>
            </div>
        </div>
        <div id="dateFilterPanel">
            <div class="col-sm-12">
                <div class="row">
                    <div class="col-sm-3">
                        <div class="form-group form-group-sm">
                            <label for="service"> Service Code</label>
                            <input [(ngModel)]="serviceCode" class="form-control" id="serviceCode"
                                placeholder="Service Code" name="serviceCode" ngControl="serviceCode"
                                #serviceEnt="ngModel">
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-group form-group-sm">
                            <label for="location">Plant </label>
                            <select [(ngModel)]="plantCode" class="form-control" id="fltrlocation" name="fltrlocation"
                                ngControl="plantCode" #fltrlocationEnt="ngModel" matTooltip="Select Location">
                                <option [ngValue]="null" disabled>--Select an Option--</option>
                                <option *ngFor="let loc of locationList" value={{loc.code}}>{{loc.code}}-{{loc.name}}
                                </option>
                            </select>

                        </div>
                    </div>
                    <div class="col-sm-3">
                        <div class="form-group form-group-sm">
                            <label for="fltrstatus">Status</label>
                            <select [(ngModel)]="status" class="form-control" id="fltrstatus" name="fltrstatus"
                                ngControl="status" #fltrstatusEnt="ngModel" matTooltip="Select Status">
                                <option [ngValue]="null" disabled>--Select an Option--</option>
                                <option *ngFor="let status of statuslist" value={{status.name}}>{{status.name}}</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="row ml-3">
                    <div class="col-sm-4">
                        <label>From Date</label>
                        <!-- <input type="date" class="form-control" placeholder="From Date"  [(ngModel)]="ItemCodeExtensionModel.from_date"/> -->
                        <div class="form-group form-group-sm"
                            [ngClass]="(fromDate.touched && !fromDate.valid)?'has-error':''">
                            <input [matTooltipPosition]="'below'" matTooltip="Click to change from date"
                                [owlDateTime]="dt11" [owlDateTimeTrigger]="dt11" [max]="today" name="fromDate"
                                class="form-control" [(ngModel)]="from_date" #fromDate="ngModel">
                            <owl-date-time [pickerType]="'calendar'" #dt11 style="width: 250px;"></owl-date-time>
                            <span class="help-block" *ngIf="!fromDate.valid && fromDate.touched">Please enter valid From
                                Date.</span>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <label>To Date</label>
                        <div class="form-group form-group-sm"
                            [ngClass]="(toDate.touched && !toDate.valid)?'has-error':''">
                            <!-- <input type="date" [disabled]="from_date==null||from_date==''" class="form-control" placeholder="To Date"  [(ngModel)]="ItemCodeExtensionModel.to_date"> -->
                            <input [min]="from_date" [max]="today" [matTooltipPosition]="'below'"
                                matTooltip="Click to change to date" [owlDateTime]="dt12" [owlDateTimeTrigger]="dt12"
                                name="endDate" class="form-control" [(ngModel)]="to_date" #toDate="ngModel">
                            <owl-date-time [pickerType]="'calendar'" #dt12 style="width: 250px;"></owl-date-time>
                            <span class="help-block" *ngIf="!toDate.valid && toDate.touched">Please enter valid To
                                Date.</span>
                        </div>
                    </div>
                    <div class="col-sm-2">
                        <label>&nbsp;</label>
                        <div class="form-group form-group-sm">
                            <button class="btn btn-primary btn-sm" (click)="getAllEntries();"
                                [disabled]="(!toDate.valid && toDate.touched) || (!fromDate.valid && fromDate.touched)"
                                matTooltip="click to go">Go</button>
                            &nbsp;&nbsp;
                            <button class="btn btn-primary btn-sm" (click)="clearFilter();"
                                matTooltip="click to reset">Clear</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- /.box-header -->
        <div class="box-body table-responsive">
            <table id="userTable" class="table table-bordered table-striped">
                <thead style="background-color: #68a7d2;color:white;">
                    <tr>
                        <!-- <th>Request No</th> -->
                        <th>Sl No</th>
                        <th>Requested By</th>
                        <th>Requested Date</th>
                        <th>Plant</th>
                        <th>Service Code</th>
                        <th>Service Description</th>
                        <th>Approve Status</th>
                        <th>Last Approver</th>
                        <th>Pending Approver</th>
                        <th>Submit for Approval</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of ServiceMasterChangesFilter; let i = index">
                        <!-- <td>{{item.requestNo}}</td> -->
                        <td>{{i+1}}</td>
                        <td>{{item.requestedBy}}</td>
                        <td>{{item.requestedDate | date:'dd/MM/yyyy HH:mm'}}</td>
                        <td>{{item.plantCode}}</td>
                        <td>{{item.serviceCode}}</td>
                        <td>{{item.serviceDescription}}</td>
                        <td>{{item.status}}</td>
                        <td>{{item.lastApprover}}</td>
                        <td>{{item.pendingApprover}}</td>
                        <td>
                            <button
                                *ngIf="item.Status =='Created' || item.Status =='Reverted to initiator' && item.createdBy==this.currentUser.employeeId"
                                type="button" [matTooltipPosition]="'after'" matTooltip="Click to Submit"
                                class="btn btn-primary btn-xs" (click)="onSubmitEntry(item)">
                                <i class="fas fa-check"></i>
                            </button>
                        </td>
                        <td>
                            <table>
                                <tr>
                                    <td>
                                        <button
                                            *ngIf="item.Status =='Created' || item.Status =='Reverted to initiator' && item.createdBy==this.currentUser.employeeId"
                                            type="button" [matTooltipPosition]="'after'"
                                            matTooltip="Click to edit details" class="btn btn-primary btn-xs"
                                            (click)="onUserActions(false,item,false)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </td>
                                    &nbsp;
                                    <td *ngIf="item.Status !='Created' && item.Status !='Reverted to initiator'">
                                        <button
                                            *ngIf="item.pendingApprover==currentUser.employeeId || item.approver1 ==userid ||  item.approver2 ==userid || 
                                                                                    item.approver3 ==userid ||  item.approver4 ==userid "
                                            type="button" [matTooltipPosition]="'after'"
                                            matTooltip="Click to edit details" class="btn btn-primary btn-xs"
                                            (click)="onUserActions(true,item,false,'')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </td>
                                    &nbsp;

                                    <td>
                                        <button type="button" [matTooltipPosition]="'after'"
                                            matTooltip="Click to view details" class="btn btn-primary btn-xs"
                                            (click)="onUserActions(true,item,false,'View')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </td>
                                    &nbsp;
                                    <td>

                                    </td>
                                    &nbsp;
                                    <td>

                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- /.box-body -->
        <div class="overlay" *ngIf="isLoading">
            <i class="fa fa-spinner fa-pulse"></i>
        </div>
    </div>
</section>

<div class="modal fade" id="saveModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
    data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-md  modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h3 class="modal-title" style="color: #0FB381; text-align: center;"><span class="text pull-center"
                        *ngIf="errMsgPop1.length>0"><i class="fa fa-check"></i>{{errMsgPop1}}</span></h3>
            </div>
        </div>
    </div>
    <div class="overlay" *ngIf="isLoading">
        <i class="fa fa-spinner fa-pulse"></i>
    </div>
</div>

<div class="modal fade" id="myModal" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
    data-backdrop="static" data-keyboard="false">

    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #68a7d2;color:white">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h3 class="modal-title">Service Master Form
                </h3>
            </div>
            <div class="modal-body box-primary" style="box-shadow: none;">
                <div class="row">
                    <div class="col-sm-12">
                        <form #dataForm="ngForm" (keydown.enter)="$event.preventDefault()">
                            <div class="row">
                                <div class="col-sm-3">
                                    <div class="form-group form-group-sm">
                                        <label for="service"> Service Code</label>
                                        <input [(ngModel)]="serviceCode" class="form-control" id="serviceCode"
                                            placeholder="Service Code" name="serviceCode" ngControl="serviceCode"
                                            #serviceCEnt="ngModel" [disabled]="isEdit">
                                    </div>
                                </div>
                                <div class="col-sm-4 pull-center" *ngIf="!isEdit"><br>
                                    <label>&nbsp;</label>
                                    <button class="btn btn-primary btn-sm" (click)="getCodeDetails(serviceCode);"
                                        [disabled]="serviceCode == null" matTooltip="Click to Search">Get Data
                                    </button>
                                </div>
                            </div>
                            <div class="box">
                                &nbsp;&nbsp;&nbsp;
                                &nbsp;&nbsp;&nbsp;
                                <div class="row">

                                    <div class="col-sm-4" *ngIf="isEdit">
                                        <div class="form-group form-group-sm">
                                            <label for="requestdate"> Request Date</label>
                                            <input name="requestdate" id="requestdate" placeholder="Request Date"
                                                class="form-control"
                                                value="{{servicemasterchangesmodel.requestDate | date:'dd/MM/yyyy'}}"
                                                readonly>
                                        </div>
                                    </div>
                                    <div class="col-sm-4" *ngIf="!isEdit">
                                        <div class="form-group form-group-sm">
                                            <label for="requestdate"> Request Date</label>
                                            <input name="requestdate" id="requestdate" placeholder="Request Date"
                                                class="form-control" value="{{requestdate | date:'dd/MM/yyyy'}}"
                                                readonly>
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="form-group form-group-sm"
                                            [ngClass]="((servicemasterchangesmodel.plantCode==null || servicemasterchangesmodel.plantCode=='' || servicemasterchangesmodel.plantCode==undefined)  && !notFirst)?'has-error':''">
                                            <label for="location">
                                                Location <span style="color:red">*</span>
                                            </label><br>
                                            <ng-select [items]="locationList" (blur)="checkLocation();" bindLabel="name"
                                                required name="location" bindValue="code" [multiple]="false"
                                                [virtualScroll]="true" placeholder="Select Location" [disabled]="isEdit"
                                                [(ngModel)]="servicemasterchangesmodel.plantCode">
                                                <ng-option *ngFor="let loc of locationList"
                                                    value={{loc.code}}>{{loc.code}}-{{loc.name}}
                                                </ng-option>
                                            </ng-select>
                                            <span class="help-block"
                                                *ngIf="(servicemasterchangesmodel.plantCode==null || servicemasterchangesmodel.plantCode=='' || servicemasterchangesmodel.plantCode==undefined) && !notFirst">Please
                                                Select Location
                                            </span>
                                        </div>
                                    </div>

                                    <div class="col-sm-4">
                                        <div class="form-group form-group-sm"
                                            [ngClass]="(!saccodeEnt.valid && saccodeEnt.touched)?'has-error':''">
                                            <label for="saccode">SAC Code<span style="color:red">*</span></label>
                                            <input [(ngModel)]="servicemasterchangesmodel.sacCode" class="form-control"
                                                placeholder="SAC Code" [minlength]="6" id="saccode" name="saccode"
                                                ngControl="servicemasterchangesmodel.sacCode" [readonly]="isEdit"
                                                matTooltip="Enter sac code" #saccodeEnt="ngModel" type="text" required
                                                [disabled]="isEdit">
                                            <span class="help-block"
                                                *ngIf="!saccodeEnt.valid && saccodeEnt.touched">Minimum length
                                                Should be 6 characters/Digits</span>
                                        </div>
                                    </div>
                                </div>
                                &nbsp;&nbsp;&nbsp;
                                &nbsp;&nbsp;&nbsp;
                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="form-group form-group-sm">
                                            <label for="serviceDescription">Service Description<span
                                                    style="color:red">*</span></label>
                                            <input [(ngModel)]="servicemasterchangesmodel.serviceDescription"
                                                class="form-control"
                                                (input)="servicemasterchangesmodel.serviceDescription=$event.target.value.toUpperCase()"
                                                id="serviceDescription" placeholder="Service Description"
                                                name="serviceDescription" [disabled]="isEdit"
                                                ngControl="servicemasterchangesmodel.serviceDescription"
                                                #serviceDescriptionEnt="ngModel" required>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group form-group-sm">
                                            <label for="detailedDesc">Detailed Service Description<span
                                                    style="color:red">*</span></label>
                                            <input [(ngModel)]="servicemasterchangesmodel.detailedServiceDescription"
                                                class="form-control" id="detailedDesc"
                                                (input)="servicemasterchangesmodel.detailedServiceDescription=$event.target.value.toUpperCase()"
                                                placeholder="Detailed description" name="detailedDesc"
                                                ngControl="servicemasterchangesmodel.detailedServiceDescription"
                                                #detailedEnt="ngModel" [disabled]="isEdit" required>
                                        </div>
                                    </div>
                                </div>
                                &nbsp;&nbsp;&nbsp;
                                &nbsp;&nbsp;&nbsp;
                                <div class="row">
                                    <div class="col-sm-3">
                                        <div class="form-group"
                                            [ngClass]="((servicemasterchangesmodel.purchaseGroup==null || servicemasterchangesmodel.purchaseGroup=='' || servicemasterchangesmodel.purchaseGroup==undefined)  && !notFirst)?'has-error':''">
                                            <label for="purchaseGroup">
                                                Purchase Group <span style="color:red">*</span>
                                            </label><br>
                                            <ng-select [items]="purchasegrouplist" (blur)="checkPurchaseGroup();"
                                                bindLabel="purchaseGroupDesc" required name="purchaseGroup"
                                                bindValue="purchaseGroupId" [multiple]="false" [virtualScroll]="true"
                                                placeholder="Select Purchase Group"
                                                [(ngModel)]="servicemasterchangesmodel.purchaseGroup"
                                                [disabled]="isEdit">
                                                <ng-option *ngFor="let mat of purchasegrouplist"
                                                    value={{mat.purchaseGroupId}}>
                                                    {{mat.purchaseGroupId}}-{{mat.purchaseGroupDesc}}
                                                </ng-option>
                                            </ng-select>
                                            <span class="help-block"
                                                *ngIf="(servicemasterchangesmodel.purchaseGroup==null || servicemasterchangesmodel.purchaseGroup=='' || servicemasterchangesmodel.purchaseGroup==undefined) && !notFirst">Please
                                                Select Purchase Group</span>
                                        </div>
                                    </div>

                                    <div class="col-sm-3">
                                        <div class="form-group"
                                            [ngClass]="((servicemasterchangesmodel.uom==null || servicemasterchangesmodel.uom=='' || servicemasterchangesmodel.uom==undefined)  && !notFirst)?'has-error':''">
                                            <label for="UOM">
                                                UOM <span style="color:red">*</span>
                                            </label><br>
                                            <ng-select [items]="uomMasterList" (blur)="checkUom();"
                                                bindLabel="description" name="UOM" bindValue="uom" [multiple]="false"
                                                [virtualScroll]="true" placeholder="Select UOM"
                                                [(ngModel)]="servicemasterchangesmodel.uom" [disabled]="isEdit"
                                                required>
                                                <ng-option *ngFor="let uom of uomMasterList"
                                                    value={{uom.uom}}>{{uom.uom}}-{{uom.description}}
                                                </ng-option>
                                            </ng-select>
                                            <span class="help-block"
                                                *ngIf="(servicemasterchangesmodel.uom==null || servicemasterchangesmodel.uom=='' || servicemasterchangesmodel.uom==undefined) && !notFirst">Please
                                                Select UOM</span>
                                        </div>
                                    </div>

                                    <div class="col-sm-3">
                                        <div class="form-group"
                                            [ngClass]="((servicemasterchangesmodel.serviceCategory==null || servicemasterchangesmodel.serviceCategory=='' || servicemasterchangesmodel.serviceCategory==undefined)  && !notFirst)?'has-error':''">
                                            <label for="serviceCategory">
                                                Service Category <span style="color:red">*</span>
                                            </label><br>
                                            <ng-select [items]="serviceCategorylist" (blur)="checkServiceCategory();"
                                                bindLabel="serCatDesc" required name="serviceCategory"
                                                bindValue="serCatCode" [multiple]="false" [virtualScroll]="true"
                                                placeholder="Select Service Category"
                                                [(ngModel)]="servicemasterchangesmodel.serviceCategory"
                                                [disabled]="isEdit">
                                                <ng-option *ngFor="let mat of serviceCategorylist"
                                                    value={{mat.serCatCode}}>
                                                    {{mat.serCatCode}}-{{mat.serCatDesc}}
                                                </ng-option>
                                            </ng-select>
                                            <span class="help-block"
                                                *ngIf="(servicemasterchangesmodel.serviceCategory==null || servicemasterchangesmodel.serviceCategory=='' || servicemasterchangesmodel.serviceCategory==undefined) && !notFirst">Please
                                                Select Serive Category</span>
                                        </div>
                                    </div>

                                    <div class="col-sm-3">
                                        <div class="form-group"
                                            [ngClass]="((servicemasterchangesmodel.serviceGroup==null || servicemasterchangesmodel.serviceGroup=='' || servicemasterchangesmodel.serviceGroup==undefined)  && !notFirst)?'has-error':''">
                                            <label for="serviceGroup">
                                                Service Group <span style="color:red">*</span>
                                            </label><br>
                                            <ng-select [items]="servicegrouplist" (blur)="checkServiceGroup();"
                                                bindLabel="stxt" required name="serviceGroup" bindValue="groupId"
                                                [multiple]="false" [virtualScroll]="true"
                                                placeholder="Select Service Group"
                                                [(ngModel)]="servicemasterchangesmodel.serviceGroup"
                                                [disabled]="isEdit">
                                                <ng-option *ngFor="let item of servicegrouplist"
                                                    value={{item.groupId}}>{{item.groupId}}-{{item.stxt}}
                                                </ng-option>
                                            </ng-select>
                                            <span class="help-block"
                                                *ngIf="(servicemasterchangesmodel.serviceGroup==null || servicemasterchangesmodel.serviceGroup=='' || servicemasterchangesmodel.serviceGroup==undefined) && !notFirst">Please
                                                Select Serive Group</span>
                                        </div>
                                    </div>

                                </div>
                                &nbsp;&nbsp;&nbsp;
                                &nbsp;&nbsp;&nbsp;
                                <div class="row">
                                    <div class="col-sm-3">
                                        <div class="form-group"
                                            [ngClass]="((servicemasterchangesmodel.valuationClass==null || servicemasterchangesmodel.valuationClass=='' || servicemasterchangesmodel.valuationClass==undefined)  && !notFirst)?'has-error':''">
                                            <label for="valuationClass">
                                                Valuation Class <span style="color:red">*</span>
                                            </label><br>
                                            <ng-select [items]="ValuationClasslist" (blur)="checkValuationClass();"
                                                bindLabel="valuationDesc" required name="valuationClass"
                                                bindValue="valuationId" [multiple]="false" [virtualScroll]="true"
                                                placeholder="Select Valuation Class"
                                                [(ngModel)]="servicemasterchangesmodel.valuationClass"
                                                [disabled]="isEdit">
                                                <ng-option *ngFor="let mat of ValuationClasslist"
                                                    value={{mat.valuationId}}>{{mat.valuationId}}-{{mat.valuationDesc}}
                                                </ng-option>
                                            </ng-select>
                                            <span class="help-block"
                                                *ngIf="(servicemasterchangesmodel.valuationClass==null || servicemasterchangesmodel.valuationClass=='' || servicemasterchangesmodel.valuationClass==undefined) && !notFirst">Please
                                                Select Valuation Class</span>
                                        </div>
                                    </div>

                                </div>
                                &nbsp;&nbsp;&nbsp;
                                &nbsp;&nbsp;&nbsp;
                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="form-group form-group-sm">
                                            <label for="justification">Justification<span
                                                    style="color:red">*</span></label>
                                            <textarea [(ngModel)]="servicemasterchangesmodel.reason"
                                                class="form-control" placeholder="justification" id="justification"
                                                name="justification" ngControl="servicemasterchangesmodel.reason"
                                                [disabled]="isEdit" matTooltip="Enter justification"
                                                #reasonEnt="ngModel" type="text" required></textarea>

                                        </div>
                                    </div>
                                </div>
                                &nbsp;&nbsp;&nbsp;
                                &nbsp;&nbsp;&nbsp;
                                <div class="row" *ngIf=" isEdit && !view ">
                                    <div class="col-sm-12">
                                        <div class="form-group form-group-sm">
                                            <label for="Customer">Comments<span style="color:red">*</span></label>
                                            <textarea [(ngModel)]="comments" class="form-control" placeholder="comments"
                                                id="comments" name="comments" ngControl="comments" [disabled]=view
                                                matTooltip="Enter Comments" #commentsEnt="ngModel" type="text"
                                                required></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;
                            <div class="box">
                                <div class="box-header" style="background-color: #b6cedf; height: 35px;">
                                    <div class="col-xs-6">
                                        <h3 class="box-title">Attachments</h3>
                                    </div>
                                </div>
                                &nbsp;&nbsp;&nbsp;
                                &nbsp;&nbsp;&nbsp;
                                <div class="row" *ngIf="!isEdit">
                                    <div class="col-sm-4">
                                        <input #myInput type="file" accept=".doc,.pdf" id="file"
                                            (change)="handleFileInput($event.target.files)" multiple>
                                    </div>
                                    <div class="col-sm-3">
                                        <span class="text-red pull-left" *ngIf="errMsg1.length>0"><i
                                                class="fa fa-warning"></i>{{errMsg1}}</span>
                                    </div>
                                    <div class="col-sm-4">
                                        <span class="text-red pull-left"><i class="fa fa-warning"></i>
                                            NOTE:Maximum Upto 2Mb Can Be Uploaded</span>
                                    </div>
                                </div>
                                &nbsp;&nbsp;&nbsp;
                                &nbsp;&nbsp;&nbsp;
                                <div class="row" *ngFor="let attach of fileslist">
                                    <div class="col-sm-4">
                                        <label for="attachments">{{attach}}</label>
                                    </div>
                                    <div class="col-sm-4" *ngIf="!isEdit && attach!= null">
                                        <button title="Remove Files" (click)="removefile(attach);"
                                            matTooltip="Click to delete" class="btn btn-secondary btn-sm">
                                            <i class="fa fa-trash"></i></button>
                                    </div>

                                </div>
                                <div class="row" *ngFor="let attach of attachments">
                                    <div class="col-sm-4">
                                        <label for="attachments"></label><a
                                            (click)="downloadFile(servicemasterchangesmodel.requestNo,attach);"
                                            style="cursor: pointer;text-decoration: underline; color: #68a7d2;"
                                            [matTooltipPosition]="'below'"
                                            matTooltip="Click to download the file">{{attach}}</a>
                                    </div>
                                    <div class="col-sm-4" *ngIf="!isEdit && attach!= null">
                                        <button title="Remove Files"
                                            (click)="deletefile(servicemasterchangesmodel,attach);"
                                            matTooltip="Click to delete" class="btn btn-secondary btn-sm">
                                            <i class="fa fa-trash"></i></button>
                                    </div>
                                </div>
                            </div>

                            &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;
                            <div class="box">
                                <div class="box-header" style="background-color: #b6cedf; height: 35px;">
                                    <div class="col-xs-6">
                                        <h3 class="box-title">Approvers List</h3>
                                    </div>
                                </div>
                                &nbsp;&nbsp;&nbsp;
                                &nbsp;&nbsp;&nbsp;
                                <div class="row" *ngIf='!isEdit'>
                                    <div class="col-sm-12">
                                        <div class="table">
                                            <table id="approversTable" class="table table-striped">
                                                <thead style="background-color: #68a7d2; color:white;">
                                                    <tr>
                                                        <th>Priority</th>
                                                        <th>Location</th>
                                                        <th>Employee ID</th>
                                                        <th>ApproverName</th>
                                                        <th>Role</th>
                                                        <th>Department</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let user of Approverslist; let i = index">
                                                        <td>{{user.priority}}</td>
                                                        <td>{{getloc(user)}}</td>
                                                        <td>{{user.approverId}}</td>
                                                        <td>{{user.approverName}}</td>
                                                        <td>{{user.role}}</td>
                                                        <td>{{user.department}}</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="row" *ngIf='isEdit'>
                                    <div class="col-sm-12">
                                        <div class="table">
                                            <table id="approversTable" class="table table-striped">
                                                <thead style="background-color: #68a7d2; color:white;">
                                                    <tr>
                                                        <th>Priority</th>
                                                        <th *ngIf="!isEdit">Location</th>
                                                        <th>Employee ID</th>
                                                        <th>ApproverName</th>
                                                        <th>Role</th>
                                                        <th>Department</th>
                                                        <th *ngIf="isEdit">Status</th>
                                                        <th *ngIf="isEdit">Date</th>
                                                        <th *ngIf="isEdit">Comments</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let user of transactionslist; let i = index">
                                                        <td>{{user.approvalPriority}}</td>
                                                        <td>{{user.doneBy}}</td>
                                                        <td>{{user.approverName}}</td>
                                                        <td>{{user.role}}</td>
                                                        <td>{{user.department}}</td>
                                                        <td>{{user.status}}</td>
                                                        <td>{{user.doneOn |date:'dd/MM/yyyy HH:mm'}}</td>
                                                        <td>{{user.comments}}</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="overlay" *ngIf="isLoadingPop">
                        <i class="fa fa-spinner fa-pulse"></i>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <span class="text-red pull-left" *ngIf="errMsgPop.length>0"><i
                        class="fa fa-warning"></i>{{errMsgPop}}</span>
                <div *ngIf="!view" class="row pull-right">
                    <div  class="dropdown ">
                    <button type="button" class="btn btn-primary" (click)="oncloserequest('close')"
                        matTooltip="Click to Close the Request" *ngIf="isEdit && Closure"
                        [disabled]="comments==''">Closure</button>
                    <button type="button" class="btn btn-primary" (click)="onCreate()" matTooltip="Click to Create"
                        [disabled]="!dataForm.valid"
                        *ngIf="isEdit && Creator && !Closure && servicemasterchangesmodel.createdBy!=this.currentUser.employeeId">Create</button>
                    <button type="button" class="btn btn-primary" (click)="onreview('InProcess')"
                        matTooltip="Click to Submit" [disabled]="!dataForm.valid"
                        *ngIf="isEdit && Review && !Closure && !Creator">Submit</button>
                    <button type="button" class="btn btn-primary" (click)="onreview('Rejected')"
                        matTooltip="Click to Reject" *ngIf="isEdit && Review && !Closure"
                        [disabled]="comments==''">Reject</button>
                    &nbsp;
                  
                         <a *ngIf="isEdit && Review" data-toggle="dropdown" class="dropdown-toggle"
                            href="#"><span>
                                <button [disabled]="comments==''" type="button" class="btn btn-primary"
                                    matTooltip="Click to Revert">Revert</button>
                            </span>
                        </a>
                        <ul *ngIf="isEdit && Review" class="dropdown-menu">
                            <li><a *ngIf="Aprlpriority >1" (click)="onRevertRequest('ReverttoLastApprover')">Previous
                                    Approver</a></li>
                            <li><a (click)="onRevertRequest('ReverttoInitiator')">Initiator</a></li>
                        </ul>
                    </div>
                    &nbsp;
                    <button type="button" class="btn btn-primary" (click)="onSaveEntry('Save')"
                        matTooltip="Click to Save" [disabled]="!dataForm.valid"
                        *ngIf="!isEdit && servicemasterchangesmodel.Status==null">Save</button>
                    <button type="button" class="btn btn-primary" (click)="onSaveEntry('Submit')"
                        matTooltip="Click to Save & Submit" [disabled]="!dataForm.valid"
                        *ngIf="!isEdit && servicemasterchangesmodel.Status==null">Save & Submit</button>
                    <button type="button" class="btn btn-primary" (click)="onSubmitEntry(servicemasterchangesmodel)"
                        matTooltip="Click to Save & Submit" [disabled]="!dataForm.valid"
                        *ngIf="!isEdit && servicemasterchangesmodel.Status=='Created' || servicemasterchangesmodel.Status =='Reverted to initiator'">Save
                        & Submit</button>
                    <button type="button" class="btn btn-primary" (click)="OnClickback()" data-dismiss="modal"
                        *ngIf="!isEdit" [disabled]="isLoadingPop" matTooltip="Click to Go Back">Back</button>
                    <button type="button" class="btn btn-primary" (click)="resetForm()" *ngIf="!isEdit"
                        matTooltip="Click to Clear">Clear</button>
                    <button type="button" class="btn btn-default" style="background-color:darkgray;color:white;"
                        data-dismiss="modal" [disabled]="isLoadingPop" matTooltip="Click to close modal">Close</button>
                </div>
                <div *ngIf="view" class="row pull-right">
                    <button type="button" class="btn btn-default" style="background-color:darkgray;color:white;"
                        data-dismiss="modal" [disabled]="isLoadingPop" matTooltip="Click to close modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>