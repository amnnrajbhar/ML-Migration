<section class="content-header">
  <h1 class="display-1">
    Education Details
  </h1>

</section>

<section class="content">

  <div class="panel panel-info" *ngIf="editAllowed">
    <div class="panel-body form-horizontal">
      <form #educationForm="ngForm">
        <div>
          <div class="row">
            <div class="col-md-4">
              <div class="form-group">
                <label class="col-md-4"> Education Level <span style="color:red">*</span></label>
                <div class="col-md-8">
                  <select [(ngModel)]="selectedEducationLevel" class="form-control" required name="educationLevelId"
                    #educationLevelEnt="ngModel" (change)="onLevelChange()">
                    <option [ngValue]="null" disabled [selected]="true"> Select Education </option>
                    <option *ngFor="let pl of educationTypes" [ngValue]="pl">{{pl.educationLevel}}</option>
                  </select>
                  <span class="help-block" *ngIf="educationLevelEnt.touched && !educationLevelEnt.valid">
                    Please select education level</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label class="col-md-4"> Course <span style="color:red">*</span></label>
                <div class="col-md-8">
                  <select [(ngModel)]="selectedCourse" class="form-control" required #courseEnt="ngModel"
                    name="courseId">
                    <option [ngValue]="null" disabled [selected]="true"> Select Course </option>
                    <option *ngFor="let pl of courseList" [ngValue]="pl">{{pl.educationCourse}}</option>
                  </select>
                  <span class="help-block" *ngIf="courseEnt.touched && !courseEnt.valid">
                    Please select course</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label class="col-md-4"> Specialisation <span style="color:red">*</span></label>
                <div class="col-md-8">
                  <input type="text" class="form-control" id="specialisation" [(ngModel)]="item.specialisation"
                    ngControl="item.specialisation" name="specialisation" #specialisationEnt="ngModel" required maxlength="30"/>
                  <span class="help-block" *ngIf="specialisationEnt.touched && !specialisationEnt.valid">
                    Please enter specialisation</span>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-4">
              <div class="form-group">
                <label class="col-md-4"> University <span style="color:red">*</span></label>
                <div class="col-md-8">
                  <input type="text" class="form-control" id="university" [(ngModel)]="item.university"
                    ngControl="item.university" name="university" #universityEnt="ngModel" required maxlength="50"/>
                  <span class="help-block" *ngIf="universityEnt.touched && !universityEnt.valid">
                    Please enter university</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label class="col-md-4"> City <span style="color:red">*</span></label>
                <div class="col-md-8">
                  <input type="text" class="form-control" id="city" [(ngModel)]="item.city" ngControl="item.city"
                    name="city" #cityEnt="ngModel" required maxlength="30"/>
                  <span class="help-block" *ngIf="cityEnt.touched && !cityEnt.valid">
                    Please enter city</span>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group">
                <label class="col-md-4">State <span style="color:red">*</span></label>
                <div class="col-md-8">
                  <select [(ngModel)]="selectedState" class="form-control" required name="stateId" 
                  (change)="onStateChange()" #stateEnt="ngModel">
                    <option [ngValue]="null" disabled [selected]="true"> Select state </option>
                    <option *ngFor="let pl of stateList" [ngValue]="pl">{{pl.bezei}}</option>
                  </select>
                  <span class="help-block" *ngIf="stateEnt.touched && !stateEnt.valid">
                    Please select state</span>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-4">
              <div class="form-group">
                <label class="col-md-4">Country <span style="color:red">*</span></label>
                <div class="col-md-8">
                  <select [(ngModel)]="selectedCountry" class="form-control" required #countryEnt="ngModel"
                    name="countryId" disabled="true">
                    <option [ngValue]="null" disabled [selected]="true"> Select Country </option>
                    <option *ngFor="let pl of countryList" [ngValue]="pl">{{pl.landx}}</option>
                  </select>
                  <span class="help-block" *ngIf="countryEnt.touched && !countryEnt.valid">
                    Please select country</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label class="col-md-4"> Duration (in years)<span style="color:red">*</span></label>
                <div class="col-md-8"><input type="text" class="form-control" [(ngModel)]="item.durationofCourse"
                    ngControl="item.durationofCourse" name="durationofCourse" placeholder="in years"
                    #durationEnt="ngModel" required />
                  <span class="help-block" *ngIf="durationEnt.touched && !durationEnt.valid">
                    Please enter duration</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label class="col-md-4"> Passing Year <span style="color:red">*</span></label>
                <div class="col-md-8">
                  <input type="number" class="form-control" [(ngModel)]="item.yearOfPassing"
                    ngControl="item.yearOfPassing" name="yearOfPassing" 
                    #yearEnt="ngModel" required maxlength="4" />
                  <span class="help-block" *ngIf="yearEnt.touched && !yearEnt.valid">
                    Please enter year of passing</span>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-4">
              <div class="form-group">
                <label class="col-md-4"> Full/Part Time <span style="color:red">*</span></label>
                <div class="col-md-8">
                  <select [(ngModel)]="item.fullorPartTime" ngControl="item.fullorPartTime" class="form-control"
                    required name="fullorPartTime" #timeEnt="ngModel">
                    <option value="Full Time">Full Time</option>
                    <option value="Part Time">Part Time</option>
                  </select>
                  <span class="help-block" *ngIf="timeEnt.touched && !timeEnt.valid">
                    Please select full / part time</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label class="col-md-4"> Percent / CGPA <span style="color:red">*</span></label>
                <div class="col-md-8"><input type="number" class="form-control" [(ngModel)]="item.percentage"
                    ngControl="item.percentage" name="percentage" min="0" step="0.01" maxlength="5" #percEnt="ngModel" required />
                  <span class="help-block" *ngIf="percEnt.touched && !percEnt.valid">
                    Please enter percentage</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label class="col-md-4"> Attachment <span style="color:red">*</span></label>
                <div class="col-md-8">
                  <input #attachment type="file" name="attachment" id="attachment" accept=".png, .jpg, .jpeg, .pdf" [(ngModel)]="item.attachment" (change)="selectFiles($event)"/>
                  <span class="text-danger">Upload image files (jpeg, png) or pdf files only. Maximum file size allowed is 2MB.</span>
                </div>
              </div>
            </div>
          </div>
          <div class="text-center">
            <button type="button"  (click)="onAddLine(attachment.files)" class="btn btn-primary btn-sm" [disabled]="isLoading"
              *ngIf="!isEdit">
              <i class="fas fa-plus"></i> Add</button>
            <button type="button" (click)="onUpdateLine()" class="btn btn-success btn-sm" [disabled]="isLoading"
              *ngIf="isEdit">
              <i class="fas fa-check"></i> Update</button>
            <button type="button" (click)="clearInput()" class="btn btn-default btn-sm">
              Cancel</button>
          </div>
          <!--div>
            <span class="text-danger">Note: School - Matriculation/Secondary education detail is mandatory. Please enter details in higher to lower order.</span>
          </div-->
        </div>
      </form>
    </div>
  </div>
  <div *ngIf="!editAllowed && profileUpdate">
    <h5>Old Values</h5>
    </div>

  <div class="table-responsive">
    <table class="table table-bordered table-striped table-hover">
      <thead>
        <tr>
          <th *ngIf="editAllowed">Action</th>
          <th>Sl No</th>
          <th>Education Level</th>
          <th>Course</th>
          <th>Specialisation</th>
          <th>University</th>
          <th>City</th>
          <th>State</th>
          <th>Country</th>
          <th>Duration</th>
          <th>Year of Passing</th>
          <th>Full/Part Time</th>
          <th>Percentage</th>
          <th>Attachment</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of educationList; let i = index">

          <td *ngIf="editAllowed">
            <button (click)="EditLine(item, i)" title="click to edit this " class="btn btn-xs btn-primary">
              <i class="fas fa-pen"></i>
            </button>
            <button (click)="RemoveLine(i)" title="click to remove this " class="btn btn-xs btn-danger">
              <i class="fas fa-times"></i>
            </button>
          </td>
          <td>{{i+1}}</td>
          <td>{{item.educationLevel}}</td>
          <td>{{item.course}}</td>
          <td>{{item.specialisation}}</td>
          <td>{{item.university}}</td>
          <td>{{item.city}}</td>
          <td>{{item.stateName}}</td>
          <td>{{item.countryName}}</td>
          <td>{{item.durationofCourse}}</td>
          <td>{{item.yearOfPassing}}</td>
          <td>{{item.fullorPartTime}}</td>
          <td>{{item.percentage}}</td>
          <td><a class="btn-link" >{{item.attachmentFileName}}</a></td>
        </tr>
      </tbody>
    </table>
  </div>
  <div *ngIf="!editAllowed && profileUpdate">
    <h5>New Values</h5>
    </div>

  <div class="table-responsive" *ngIf="!editAllowed && profileUpdate">
    <table class="table table-bordered table-striped table-hover">
      <thead>
        <tr>
          <th>Sl No</th>
          <th>Action</th>
          <th>Education Level</th>
          <th>Course</th>
          <th>Specialisation</th>
          <th>University</th>
          <th>City</th>
          <th>State</th>
          <th>Country</th>
          <th>Duration</th>
          <th>Year of Passing</th>
          <th>Full/Part Time</th>
          <th>Percentage</th>
          <th>Attachment</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of profileDetailsList.educationDetails; let i = index">

          <td>{{i+1}}</td>
          <td><span class="label label-default label-{{item.statusColor}}">{{item.action}}</span></td>
          <td>{{item.educationLevel}}</td>
          <td>{{item.course}}</td>
          <td>{{item.specialisation}}</td>
          <td>{{item.university}}</td>
          <td>{{item.city}}</td>
          <td>{{item.stateName}}</td>
          <td>{{item.countryName}}</td>
          <td>{{item.durationofCourse}}</td>
          <td>{{item.yearOfPassing}}</td>
          <td>{{item.fullorPartTime}}</td>
          <td>{{item.percentage}}</td>
          <td><a class="btn-link" >{{item.attachmentFileName}}</a></td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="overlay text-center h3" *ngIf="isLoading">
    <i class="fa fa-spinner fa-pulse"></i>
  </div>

</section>