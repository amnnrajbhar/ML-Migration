<section class="content-header" >
    <h1>
      VMS Report
    </h1>
    <ol class="breadcrumb">
      <li><a href="#"><i class="fa fa-database" aria-hidden="true"></i> VMS</a></li>
      <li class="active">VMS Report</li>
    </ol>
  </section>
  <section class="content" >
    <div class="box">
      <div class="box-header">
        <div class="col-xs-6">
          <h3 class="box-title">Employee wise Report </h3>
          <span class="label label-danger" *ngIf="errMsg.length>0">{{errMsg}}</span>
        </div>
        <!-- <div class="col-xs-6">
           <button type="button" class="btn btn-primary pull-right" (click)="onAddAssess(false,assessItem)"><i class="fa fa-plus" aria-hidden="true"></i>Add Assesment</button> 
          <button class="btn btn-primary" style="float:right" (click)="exportAsXLSX()"><i class="fa fa-file-excel-o"></i></button>
        </div> -->
      </div>
      <!-- /.box-header -->
      <div class="box-body table-responsive">
  
        <table id="assessment" class="table table-bordered table-striped">
          <thead>
            <tr>
              <th style="width:20px">Sl. No</th>
             
                  <th>Name</th>
                  <th>Designation</th>
                  <th>Emp Id</th>
                  <!-- <th>id</th> -->
                  <th>Email</th>
                  <th>Actions</th>
                
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let emp of EmployeeList;  let i = index">
                  <td>{{i+1}}</td>
                  <td>{{emp.gridEmpData[0]}}</td>
                  <td>{{emp.gridEmpData[1]}}</td>
                  <td>{{emp.gridEmpData[2]}}</td>
                  <!-- <td>{{emp.gridEmpData[4]}}</td> -->
                  <td>{{emp.gridEmpData[3]}}</td>
                  <td>
                  <button class="btn btn-primary btn-xs" (click)="review(emp.gridEmpData[4])"><i class="fa fa-eye"></i></button>&nbsp;&nbsp;
                  </td>
                  
            </tr>
          </tbody>
          <tfoot>
              <tr>
                <th style="width:20px">Sl. No</th>
               
                    <th>Name</th>
                    <th>Designation</th>
                    <th>Emp Id</th>
                    <!-- <th>id</th> -->
                    <th>Email</th>
                    <th>Actions</th>
                  
                  </tr>
                </tfoot>
        </table>
     
      </div>
      <!-- /.box-body -->
      <div class="overlay" *ngIf="isLoading">
        <!--<i class="fa fa-refresh fa-spin"></i>--> <i class="fa fa-spinner fa-pulse"></i>
      </div>
    </div>
  </section>
  <div  class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static"
     data-keyboard="false">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header bg-gradient-primary" style="color: white">
       
        <h4 class="modal-title">Visitors list</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <div class="modal-body box box-primary" style="border-top:none;">
        <!-- <div class="card"  style="border:none;">
          <div class="card-body"> -->
              <div class="row p-2">
                  <div class="row mt-5 mb-5">
                      <div class="col-lg-12  flex-fluid">
                        <button class="btn btn-primary float-left" id="slide_button" >
                          <i class="fa fa-calendar" style="cursor: pointer;"> Add Filter</i>
                        </button>
                        
                      <!-- <button id="slide_button"> <i class="fa fa-calendar"></i></button> -->
                      </div>
                      <div class="col-lg-12 mt-2"> 
                  <div id="slide"  style="display:none;">
                  
                    <div class="col-lg-4"><input type="date" class="form-control" placeholder="From"  [(ngModel)]="from_date"/></div>
                    <div class="col-lg-4"><input type="date" [disabled]="from_date==null||from_date==''" class="form-control" placeholder="To"  [(ngModel)]="to_date"></div>
                    <div class="col-lg-4"><button class="btn btn-primary" (click)="dashboardRefresh();">Go</button></div>
                  </div>
                </div> 
                  </div>
                  
                  <div class="row m-3 pt-5">
                      <div class="col-lg-12  flex-fluid">
                          <button class="btn btn-primary float-right" (click)="exportAsXLSX();" style="cursor: pointer;">
                            <i class="fa fa-download"> Generate Report</i>
                          </button>
                          </div>
                <!-- </div> -->
    
                          <!-- <div class="row"> -->
                      <div class="col-lg-12">
                          
                              <!-- <div class="card-header">
                                <h3>Visitors Details</h3>
                              </div> -->
                                  
                                  <div class="table-responsive">
                                      <table id="userTable" class="table mt-3">
                                        <thead>
                                          <tr>
                                              <th>SNo</th>
                                              <th>Employee<br> Name</th>
                                              <th>Visitor<br> Name</th>
                                              <th>Mobile</th>
                                              <th>Email</th>
                                              <th>Date</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                          <tr *ngFor="let user of visitorsList; let i = index">
                                              <td>{{i+1}}</td>
                                            <td>{{user.fkEmployeeName}}</td>
                                            <td>{{user.name}}</td>
                                            <td>{{user.mobile}}</td>
                                            <td>{{user.email}}</td>
                                            <td>{{user.date | date:'dd/MM/yyyy'}}</td>
                                          </tr>
                                        </tbody>
                                       </table>
                                    </div>
                             
                              
                      <!-- </div> -->
                      <!-- </div> -->
                 
              <!-- </div>
          </div> -->
        </div>
          
      </div>
      <div class="modal-footer">
        <span class="text-red pull-left" *ngIf="errMsgPop.length>0"><i class="fa fa-warning"></i>{{errMsgPop}}</span>
        <button type="button" class="btn btn-default" style="background-color:darkgray;color:white;" data-dismiss="modal" [disabled]="isLoadingPop">Close</button>
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>